<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <body>

        <ui:composition template="./../../../_templateBlank.xhtml">

            <ui:define name="app-admin.contentBlank">


                <p:panel header="Descargar Exel">
                    <div align="center">
                        <h:form id="ff_">

                            <h:outputText value="#{informexControl.generarExcel(param.desde_, param.hasta_, param.idbenefactor_, param.documento_,param.idpasarela)}"/>
                            <h:outputText value="#{informexControl.recuperaExel(param.desde_,param.hasta_)}"/>
                            <p:panelGrid columns="2">



                                <a href="#{informexControl.urleXEL}" onclick="descargar();">Descargar</a>
                                <p:commandButton type="button" value="Cerrar" id="cerrar" style="width: 100%;height: 30px;color:#2f4050 !important" ajax="true" onclick="cerrar()"  />

                            </p:panelGrid>




                        </h:form>



                        <script>


                            function descargar() {

                                swal({type: "success", title: 'Â¡Mensaje!', text: '"Archivo Descargado..'});


                                setTimeout(mostrarAlerta, 3000);
                            }

                            function mostrarAlerta() {
                                parent.$.fn.colorbox.close();
                            }

                            function cerrar() {
                                parent.document.location.href = '#{utilControl.protocolHostPortContext}/app-admin/informex/informe1/detalle/generarinforme.xhtml?desde_=#{param.desde_}&amp;hasta_=#{param.hasta_}&amp;idbenefactor_=#{param.idbenefactor_}&amp;documento_=#{param.documento_}&amp;idpasarela_=#{param.idpasarela_}';
                                    }
                                    ;
                        </script>
                    </div>
                </p:panel>


            </ui:define>

        </ui:composition>

    </body>
</html>
